# Lets store all our function at one place

# set your gmail and email
git config --global user.email "$gmail"
git config --global user.name "$github_username"

# lets store some variables
github_repo="https://$CIRRUS_REPO_OWNER:$github_token@github.com/$CIRRUS_REPO_FULL_NAME -b $CIRRUS_DEFAULT_BRANCH"

# login in github before uploading
echo $github_token > mytoken.txt # login in github
gh auth login --with-token < mytoken.txt

# upload our rom zip
upload () {
upload_link=https://github.com/$github_username/$github_reponame
gh release create rom --generate-notes --repo $upload_link
gh release upload --clobber $rom $1 --repo $upload_link
echo "Link: $repo_link/releases/download/rom/$1"
}

# Compress function with pigz for faster compression
com () {
tar --use-compress-program="pigz -k -$2 " -cf $1.tar.gz $1
}

# install apt 
install_apt () {
curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg
chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | tee /etc/apt/sources.list.d/github-cli.list > /dev/null
apt update && apt install wget pigz gh
}
